<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}" href="../static/css/common.css">
    <link rel="stylesheet" type="text/css" th:href="@{/layui/css/layui.css}" href="../static/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/obj-info.css}" href="../static/css/obj-info.css">
</head>
<body>
<div class="obj-info-box layui-form">
    <div class="obj-info-center">
        <p>正在从模板创建项目</p>
        <input type="text" name="projectName" class="projectName" placeholder="请填写项目名称">
        <div class="obj-info-bottom">
            <button id="project" lay-submit class="layui-btn layui-btn-fluid" lay-filter="Project" style="background-color: #017ECA">完成创建</button>
        </div>
    </div>
</div>

</body>
<script th:src="@{/js/jquery-2.2.4.min.js}" src="../static/js/jquery-2.2.4.min.js"></script>
<script th:src="@{/layui/layui.js}" src="../static/layui/layui.js"></script>
<script>

    layui.use('form', function(){
        var form = layui.form;
        //监听提交
        form.on('submit(Project)', function(){
            var projectName = $('.projectName').val();
            if(projectName===''){
                layer.msg('请填入项目名称',{icon:5});
                return false;
            }
            var index = layer.load(1, {shade: [0.1,'#fff']});
            $.post("/project/projectTemplate",{"projectName":projectName},function (data) {
                layer.close(index);
                if(data.result===1){
                    //创建项目成功之后进入任务主界面
                    parent.layer.closeAll();
                    parent.window.location.href = "/project/task.html?projectId="+data.projectId;
                }else{
                    layer.msg(data.msg,{icon:5});
                }
            });
            return false;
        });
    });

</script>
</html>