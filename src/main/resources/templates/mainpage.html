<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common/common_header :: common_header(~{::title},~{::link})">
    <meta charset="UTF-8">
    <title>主页面</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}" href="../static/css/common.css">
    <link rel="stylesheet" type="text/css" th:href="@{/layui/css/layui.css}" href="../static/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/mainpage.css}" href="../static/css/mainpage.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/commonhead.css}" href="../static/css/commonhead.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/share.css}" href="../static/css/share.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/revisetask.css}" href="../static/css/revisetask.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/myscheduling.css}" href="../static/css/myscheduling.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/chat.css}" href="../static/css/chat.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/file.css}" href="../static/css/file.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/group.css}" href="../static/css/group.css">
</head>
<body>
<!--头部-->
<header th:include="common/header::frag (${user.userInfo.image},${user.id})"></header>
<div th:include="toper::toper (${project.projectName},${project.projectId})"></div>
<!--内容区域-->
<div class="content-wrap-wrap boxsizing">
   <div class="content boxsizing">
       <input type="hidden" th:value="${project.projectId}" id="projectId">
        <!--产品设计任务页面-->
        <div class="view boxsizing">
             <div class="board-scrum-view boxsizing">
               <ul class="board-scrum-stages boxsizing" id="menuList">
                   <!--待处理-->
                   <li class="model boxsizing" th:each="taskMenu:${taskMenus}">
                       <div class="model-title">
                           <span th:text="${taskMenu.relationName}">待处理</span>
                           <i class="layui-icon layui-icon-down add-new-model xjt" style="font-size: 15px; color: #B5B5B5;" title="添加或编辑任务列表"></i>
                           <!--点击下箭头出现的内容-->
                       </div>
                       <!--任务列表-->
                       <div class="ul-wrap layui-form">
                           <ul th:id="${taskMenu.relationId}" class="taskList">
                               <li class="assignment" th:each="task:${taskMenu.taskList}" th:id="${task.taskId}" th:onclick="'javascript:updateTask(\''+ ${task.taskId} +'\',\''+ ${task.projectId} +'\')'">
                                   <div class="assignment-top-box boxsizing">
                                       <input type="checkbox" name="" title="" lay-skin="primary" class="is-sure" >
                                       <span class="assignment-title" th:text="${task.taskName}">设计修改任务界面</span>
                                       <img class="assignment-tx" th:if="${task.taskMember != null}" src="../static/image/add.png"  th:src="#{IMAGE_SERVER}+${task.taskMember.memberImg}" />
                                       <img class="assignment-tx" th:if="${task.taskMember == null}" src="/image/add.png" th:src="@{/image/add.png}"/>
                                   </div>
                                   <div class="assignment-bottom-box">
                                       <!--<span class="timer">今天9:00-明天</span>-->
                                   </div>
                                   <!--//左边框线-->
                                   <div class="line"></div>
                               </li>
                           </ul>
                       </div>
                       <!--添加任务按钮-->
                       <div class="add-assignment" th:data="${project.projectId}">
                           <i class="layui-icon layui-icon-add-circle add-icon" style="font-size: 22px; color: #80BEE4;"></i>
                           <span>添加任务</span>
                       </div>
                   </li>

                   <!--新建任务列表-->
                   <div class="creat-model boxsizing">
                       <div class="noclick-creat-model">
                           <i class="layui-icon layui-icon-add-circle" style="font-size: 22px; color: #AEAEAE;"></i>
                           <span>新建任务列表</span>
                       </div>
                       <div class="click-creat-model" style="display: none">
                           <input type="text" name="title"  placeholder="新建任务列表..." autocomplete="off" class="layui-input creat-model-input">
                           <div class="clearfix">
                               <div class="creat-model-ok layui-btn layui-btn-normal">保存</div>
                               <div class="creat-model-no">取消</div>
                           </div>
                       </div>
                   </div>
               </ul>
             </div>
          </div>
   </div>
 </div>
<!--点击群组 出现的弹框-->
<div class="group-box">
    <div class="group-title boxsizing">
        <h3>项目成员</h3>
        <i class="layui-icon layui-icon-close close-tk" style="font-size: 20px; color: #a6a6a6;"></i>
    </div>
    <!--<div class="search-box">-->
    <!--<input class="boxsizing" type="text" placeholder="搜索成员，或输入邮箱直接邀请">-->
    <!--</div>-->
    <div class="add-new-member boxsizing" style="margin-top: 15px">
        <img src="../static/image/adds.png" th:src="@{/image/adds.png}">
        <span>邀请新成员</span>
    </div>
    <ul class="group-people">
        <li class="boxsizing" th:each="projectMember:${projectMembers}">
            <img th:src="#{IMAGE_SERVER}+${projectMember.memberImg}">
            <div class="group-people-info">
                <p class="people-info-name" th:text="${projectMember.memberName}">名字</p>
                <p class="people-info-email" th:text="${projectMember.memberEmail}">abc1321555.com</p>
            </div>
            <i class="layui-icon layui-icon-down" style="font-size: 20px; color: #a6a6a6;" th:if="${projectMember.memberLable==0}" th:data="${projectMember.id}"></i>
        </li>
    </ul>
</div>
<!--邀请新成员-->
<div class="search_prople fuzhi-lianjie boxsizing" style="display: none">
    <input type="text" name="keyword"  placeholder="输入手机号/邮箱查找" autocomplete="off" class="layui-input keyword">
    <div class="people-box">
        <ul>
            <li>
                <img src="" >
                <span class="people-name"></span>
                <span class="people-state"></span>
            </li>
        </ul>
    </div>
</div>
<!--点击群组中的 人 出现的弹框-->
<!--<div style="display: none" class="people-info">-->
    <!--<div class="people-info-head boxsizing">-->
        <!--<img src="../static/image/begintime.png" >-->
        <!--<div class="people-info-head-right">-->
            <!--<h3>名字</h3>-->
            <!--<p class="over-hidden">13155aslmd.com</p>-->
            <!--<p class="over-hidden">最后登陆于2013年3月3日12:00</p>-->
        <!--</div>-->
        <!--<i class="layui-icon layui-icon-close close-people" style="font-size: 20px; color: #a6a6a6;"></i>-->
    <!--</div>-->
    <!--<div class="borders"></div>-->
    <!--<div class="look-task boxsizing">-->
        <!--<img src="../static/image/xmxx.png" th:src="@{/image/xmxx.png}">-->
        <!--<span>查看成员项目内任务</span>-->
    <!--</div>-->
    <!--<div class="set-qx boxsizing">-->
        <!--<img src="../static/image/xmxx.png" th:src="@{/image/xmxx.png}">-->
        <!--<span>查看成员项目内任务</span>-->
        <!--<p class="qx">拥有者</p>-->
    <!--</div>-->
    <!--<div class="sixin-btn">私信</div>-->
<!--</div>-->

<script th:src="@{/js/jquery-2.2.4.min.js}" src="../static/js/jquery-2.2.4.min.js"></script>
<script th:src="@{/layui/layui.js}" src="../static/layui/layui.js"></script>
<script th:src="@{/js/Sortable.min.js}" src="../static/js/Sortable.min.js"></script>
<script th:src="@{/js/mainpage.js}" src="../static/js/mainpage.js"></script>
<script th:src="@{/js/file.js}" src="../static/js/file.js"></script>
<script th:src="@{/js/sockjs.js}" src="../static/js/sockjs.js"></script>
<script th:src="@{/js/stomp.js}" src="../static/js/stomp.js"></script>
<script th:src="@{/js/mainPageSocket.js}" src="../static/js/mainPageSocket.js"></script>

</body>
<script th:inline="javascript">

    var IMAGE_SERVER = [[#{IMAGE_SERVER}]];
    var groupId = [[${currentGroup}]];

   layui.use('element', function(){
       var element = layui.element;

   });

   $('.creat-model-ok').click()

   $("#fileButton").click(function () {
       var projectId = getQueryString("projectId");
       $("#file").load("/file/list.html?projectId=" + projectId);
   });


   function getQueryString(name)
   {
       var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
       var r = window.location.search.substr(1).match(reg);
       if(r!=null)return  unescape(r[2]);
       return null;
   }

   function changeExecutor(taskId,image){
       var div = $('#'+taskId + ' div').first();
       $(div).children('img:eq(0)').attr('src',image);
   }

   function clearExecutor(taskId){
       var div = $('#'+taskId + ' div').first();
       $(div).children('img:eq(0)').attr('src','/image/add.png');
   }


   $('.remove-he').click(function (e) {
       $.post("");


   });

   $('.keyword').keyup(function (e) {
       var index = layer.load(1, {shade: [0.1,'#fff']});
        $.post('/project/searchMember',{"keyword":$('.keyword').val()},function (data) {
            layer.close(index);
        });

   });

</script>


</html>
