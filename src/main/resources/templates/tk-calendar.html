<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}" href="../static/css/common.css">
    <link rel="stylesheet" type="text/css" th:href="@{/layui/css/layui.css}" href="../static/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/fullcalendar.css}" href="../static/css/fullcalendar.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/calendar.css}" href="../static/css/calendar.css">
</head>
<body>

<div class="calendar-box">
    <i class="layui-icon layui-icon-close close-tk" style="font-size: 18px; color: #a6a6a6;top: 17px;"></i>
    <div class="calendar-box-left boxsizing layui-form">
        <div>
            <input type="checkbox" name="" title="任务" lay-skin="primary">
            <input type="checkbox" name="" title="日程" lay-skin="primary">
        </div>

        <div class="search-box">
            <input class="boxsizing" type="text" placeholder="搜索">
            <i class="layui-icon layui-icon-search" style="font-size: 18px; color: #AAAAAA;"></i>
        </div>
        <ul class="calendar-people">
            <li >
                <img src="../static/image/begintime.png" th:src="@{/image/adds.png}" />
                <span>谁谁谁</span>
                <i class="layui-icon layui-icon-ok" style="font-size: 18px; color: gray;"></i>
            </li>
        </ul>
        <div class="add-gz">添加关注</div>
    </div>


    <div class="calendar-box-right">
        <div id="calendar"></div>
    </div>

</div>
<!--创建任务 创建日程 按钮-->
<div class="create-rw-rc" style="display: none">
    <ul>
        <li class="boxsizing create-task-btn"><i class="layui-icon layui-icon-rate" style="font-size: 16px; color: #A3A3A3;"></i> <span>创建任务</span></li>
        <li class="boxsizing create-rc-btn"><i class="layui-icon layui-icon-date" style="font-size: 16px; color: #A3A3A3;"></i> <span>创建日程</span></li>
    </ul>
</div>
</body>
<script th:src="@{/js/jquery-2.2.4.min.js}" src="../static/js/jquery-2.2.4.min.js"></script>
<script th:src="@{/layui/layui.js}" src="../static/layui/layui.js"></script>
<script th:src="@{/js/moment.min.js}" src="../static/js/moment.min.js"></script>
<script th:src="@{/js/jquery-ui-1.10.2.custom.min.js}" src="../static/js/jquery-ui-1.10.2.custom.min.js"></script>
<script th:src="@{/js/fullcalendar.min.js}" src="../static/js/fullcalendar.min.js"></script>
<script>
    layui.use('form', function(){
        var form = layui.form;

        //监听提交
        form.on('submit(formDemo)', function(data){
            layer.msg(JSON.stringify(data.field));
            return false;
        });


    });
    $(function () {

        //点击 关闭按钮  关闭弹出层
        $(".close").click(function () {
            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
            parent.layer.close(index); //再执行关闭
        });

    });




    $(document).ready(function() {


        $('#calendar').fullCalendar({
            header: {
                left: ' month,agendaWeek,agendaDay',
                center: 'title',
                right: 'prev,today,next'
            },
            buttonIcons:{ prev: 'circle-triangle-w', next: 'circle-triangle-e' },
            monthNames: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
            monthNamesShort: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
            dayNames: ["周日", "周一", "周二", "周三", "周四", "周五", "周六"],
            dayNamesShort: ["周日", "周一", "周二", "周三", "周四", "周五", "周六"],
            today: ["今天"],
            firstDay: 0,
            buttonText: {today: '本月', month: '月', week: '周', day: '日', prev: '上一月', next: '下一月'},
            weekends: true,
            weekMode: 'liquid',
            defaultView: 'month',
            allDayText: '全天',
            businessHours: true,
            defaultEventMinutes: 120,
            eventLimit: true,
            option:'zh-cn',
            handleWindowResize:true,
            theme:true,
            aspectRatio: 1.7,

            dayClick : function( date ) {
                // console.log('dayClick触发的时间为：', date.format());
                console.log($(this).height());
                create($(this).offset().top+$(this).height(),$(this).offset().left)

            },
            //设置是否可被单击或者拖动选择
            selectable: true,
            //点击或者拖动选择时，是否显示时间范围的提示信息，该属性只在agenda视图里可用
            selectHelper: true,
            //点击或者拖动选中之后，点击日历外的空白区域是否取消选中状态 true为取消 false为不取消，只有重新选择时才会取消
            unselectAuto: true,
            select: function( start, end ){
                //do something here...
                console.log('select触发的开始时间为：', start.format());
                console.log('select触发的结束时间为：', end.format());
                // ...
            },
            //点击 具体 事项
            eventClick : function( event ){
                //do something here...
                console.log('eventClick中选中Event的id属性值为：', event.id);
                console.log('eventClick中选中Event的title属性值为：', event.title);
                console.log('eventClick中选中Event的start属性值为：', event.start.format('YYYY-MM-DD HH:mm'));
                console.log('eventClick中选中Event的end属性值为：', event.end==null?'无':event.end.format('YYYY-MM-DD HH:mm'));
                console.log('eventClick中选中Event的color属性值为：', event.color);
                console.log('eventClick中选中Event的className属性值为：', event.className);
                reviseSchedule()
            },
            eventMouseover : function( event ) {
                //do something here...
                console.log('鼠标经过 ...');
                console.log('eventMouseover被执行，选中Event的title属性值为：', event.title);
                // ...
            },
            eventMouseout : function( event ) {
                //do something here...
                console.log('eventMouseout被执行，选中Event的title属性值为：', event.title);
                console.log('鼠标离开 ...');
                // ...
            },
            //Event是否可被拖动或者拖拽
            editable: true,
            //Event被拖动时的不透明度
            dragOpacity: 0.5,
            eventDrop : function( event, dayDelta, revertFunc ) {
                //do something here...
                console.log('eventDrop --- start ---');
                console.log('eventDrop被执行，Event的title属性值为：', event.title);
                if(dayDelta._days != 0){
                    console.log('eventDrop被执行，Event的start和end时间改变了：', dayDelta._days+'天！');
                }else if(dayDelta._milliseconds != 0){
                    console.log('eventDrop被执行，Event的start和end时间改变了：', dayDelta._milliseconds/1000+'秒！');
                }else{
                    console.log('eventDrop被执行，Event的start和end时间没有改变！');
                }
                //revertFunc();
                console.log('eventDrop --- end ---');
                // ...
            },
            eventResize : function( event, dayDelta, revertFunc ) {
                //do something here...
                console.log(' --- start --- eventResize');
                console.log('eventResize被执行，Event的title属性值为：', event.title);
                if(dayDelta._days != 0){
                    console.log('eventResize被执行，Event的start和end时间改变了：', dayDelta._days+'天！');
                }else if(dayDelta._milliseconds != 0){
                    console.log('eventResize被执行，Event的start和end时间改变了：', dayDelta._milliseconds/1000+'秒！');
                }else{
                    console.log('eventResize被执行，Event的start和end时间没有改变！');
                }
                //revertFunc();
                console.log('--- end --- eventResize');
                // ...
            },
            events: [
                {
                    id: 1,
                    title: '这是一个all-day数据',
                    allDay: true,
                    start: '2018-07-05',
                    textColor:'#383838',
                    backgroundColor :'#CDEEFD'
                },
                {
                    id: 2,
                    title: '开始时间为12PM',
                    start: '2016-08-11 12:00'
                },
                {
                    id: 3,
                    title: '给一点颜色',
                    start: '2016-08-11',
                    color: 'red'
                },
                {
                    id: 4,
                    title: '使用className:done',
                    start: '2016-08-10 09:00',
                    end: '2016  -08-11 18:00',
                    color: 'blue',
                    className: 'done'

                },
                {
                    id: 5,
                    title: '使用className:doing',
                    start: '2016-08-11 09:00',
                    end: '2016-08-12 18:00',
                    color: 'green',
                    className: 'doing'

                },
                {
                    id: 6,
                    title: '使用URL和字体颜色',
                    start: '2016-08-11',
                    color: 'pink',
                    url: 'http://flovel.xyz',
                    className: 'doing',
                    textColor: 'black'
                },
                {
                    id: 7,
                    title: '使用backgroundColor和borderColor',
                    start: '2016-08-11 09:00',
                    end: '2016-08-12 18:00',
                    backgroundColor: 'gray',
                    borderColor: 'red',
                    className: 'done'

                },

            ]
        });
    });
    
    
    //点击创建任务 按钮
    $("html").on("click",".create-task-btn",function () {
        createRenwu()

    });
    // 点击创建日程 按钮
    $("html").on("click",".create-rc-btn",function () {
        createRicheng()

    });
    //关闭 弹框
    $(".close-tk").click(function () {
        var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
        parent.layer.close(index); //再执行关闭
    });

// 创建任务 创建日程 弹框
    function create(top,left) {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 1,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false, //标题
                offset:[top,left],
                area:['200px','90px'],
                fixed: true,
                shadeClose: true,
                closeBtn: 0,
                shade: [0.1, '#fff'],
                anim: 1,  //动画 0-6
                content: $(".create-rw-rc")
            });
        });
    }

    //创建任务 弹框
    function createRenwu() {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 2,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false, //标题
                area:['600px','440px'],
                fixed: false,
                closeBtn: 0,
                shadeClose: true, //点击遮罩关闭
                anim: 1,  //动画 0-6
                content: '/task/createCalendarTasktk.html'
            });
        });
    }
    //创建日程 弹框
    function createRicheng() {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 2,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false, //标题
                area:['600px','400px'],
                fixed: false,
                closeBtn: 0,
                // shade: 0,
                shadeClose: true, //点击遮罩关闭
                anim: 1,  //动画 0-6
                content: 'tk-calendar-create-rc.html',
                zIndex: layer.zIndex, //重点1
                success: function(layero){
                    layer.setTop(layero); //重点2
                }
            });
        });
    }
    //修改日程 弹框
    function reviseSchedule() {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 2,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false, //标题
                area:['600px','540px'],
                fixed: false,
                closeBtn: 0,
                shadeClose: true, //点击遮罩关闭
                anim: 1,  //动画 0-6
                content: 'tk-calendar-change-content.html',
                zIndex: layer.zIndex, //重点1
                success: function(layero){
                    layer.setTop(layero); //重点2
                }
            });
        });
    }


</script>
</html>