<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}" href="../static/css/common.css">
    <link rel="stylesheet" type="text/css" th:href="@{/layui/css/layui.css}" href="../static/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/search-people.css}" href="../static/css/search-people.css">
</head>
<body>
<!--人员 参与者 弹框-->
<div class="people boxsizing">
    <input type="text" name="" placeholder="搜索" class="layui-input">
    <div class="peoples">
        <div>
            <p>参与者</p>
            <div class="one-people" th:each="user:${users}" th:id="${user.id}">
                <img src="../static/image/begintime.png" th:src="#{IMAGE_SERVER}+${user.userInfo.image}" />
                <span th:text="${user.userName}"></span>
                <i class="layui-icon layui-icon-ok" style="font-size: 16px; color: #D1D1D1;display: block"></i>
            </div>
        </div>
        <p>推荐</p>
        <div class="one-people" th:if="${#lists.isEmpty(members)}" th:text="暂无成员推荐">

        </div>
        <div class="one-people" th:each="member:${members}" th:id="${member.id}">
            <img  th:src="#{IMAGE_SERVER}+${member.userInfo.image}" />
            <span th:text="${member.userName}"></span>
            <i class="layui-icon layui-icon-ok" style="font-size: 16px; color: #D1D1D1;"></i>
        </div>
        <!--<div class="add-new-people">-->
            <!--<img src="../static/image/adds.png" th:src="@{/image/adds.png}" />-->
            <!--<span>邀请新成员</span>-->
        <!--</div>-->
    </div>
    <div class="people-ok">确定</div>
</div>
</body>
<script th:src="@{/js/jquery-2.2.4.min.js}" src="../static/js/jquery-2.2.4.min.js"></script>
<script th:src="@{/layui/layui.js}" src="../static/layui/layui.js"></script>
<script th:inline="javascript">
    var taskId = [[${taskId}]];
    /**
     * 点击人员 弹框 确定 按钮
     */
    $(".people-ok").click(function () {
        //参与者 确定
        var memberIds=[];
        $('.one-people').each(function (data,item) {
            if($(item).find('i').is(':visible')){
                memberIds.push($(item).attr('id'));
            }
        });

        var url = "/task/addAndRemoveTaskMember";
        var args = {"taskId":taskId,"memberIds":memberIds.toString()};
        $.post(url,args,function (data) {
            if(data.result === 1){
                var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                parent.layer.close(index); //再执行关闭
            }
        },"json");

    });

      $(".one-people").click(function () {
          $(this).find('i').toggle();
      });


</script>
</html>