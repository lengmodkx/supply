<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}" href="../static/css/common.css">
    <link rel="stylesheet" type="text/css" th:href="@{/layui/css/layui.css}" href="../static/layui/css/layui.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/calendar-change-content.css}" href="../static/css/calendar-change-content.css">

</head>
<body>
<!-- 日历页面 修改 日程-->

<div class="change-schedule  layui-form">
    <div class="scroll-box">
       <div class="white-box boxsizing">
           <div class="change-schedule-title">
               <div class="change-schedule-title-left"><span>bim5d 新手引导</span></div>
               <div class="change-schedule-title-right">
                   <img class="zan" src="../static/image/zan.png" th:src="@{/image/zan.png}" />
                   <i class="layui-icon layui-icon-down assignment-menu-show" style="font-size: 18px; color: #a6a6a6;"></i>
                   <i class="layui-icon layui-icon-close close-revise-task" style="font-size: 18px; color: #a6a6a6;"></i>
               </div>
           </div>
           <div class="schedule-name">
               <input class="boxsizing" type="text" value="我是日程名称">
           </div>

           <div class="who-and-time">

               <div class="time-wrap">
                   <p>开始时间</p>
                   <input type="text" class="layui-input kaishi-time" id="beginTimes" placeholder="设置开始时间" th:value = "${#dates.format(task.startTime,'yyyy-MM-dd HH:mm')}"/>
               </div>
               <div class="time-wrap">
                   <p>结束时间</p>
                   <input type="text" class="layui-input jieshu-time" id="overTimes" placeholder="设置截止时间" th:value="${#dates.format(task.endTime,'yyyy-MM-dd HH:mm')}" />
               </div>

               <div class="no-repeat">
                   <input type="hidden" th:value="${task.repeat}" id = "oldRepeat"/>
                   <img class="repeat-img" src="../static/image/norepeat.png" th:src="@{/image/norepeat.png}" />
                   <select name="repeat" lay-verify="" lay-filter = "repeat">
                       <option value="不重复" th:selected="${task.repeat == '不重复'}" th:text="${task.repeat}">不重复</option>
                       <option value="每天重复" th:selected ="${task.repeat == '每天重复'}">每天重复</option>
                       <option value="每周重复" th:selected ="${task.repeat == '每周重复'}" >每周重复</option>
                       <option value="每月重复" th:selected="${task.repeat == '每月重复'}">每月重复</option>
                       <option value="每年重复" th:selected="${task.repeat == '每年重复'}" >每年重复</option>
                       <option value="工作日重复" th:selected="${task.repeat == '工作日重复'}" >工作日重复</option>
                   </select>
               </div>

               <div class="no-remand ">
                   <img class="remand-img" src="../static/image/noremand.png" th:src="@{/image/noremand.png}" />
                   <input type="hidden" th:value="${task.remind}" id = "oldRemind"/>
                   <select name="remand" lay-verify="" lay-filter = "remind">
                       <option value="不提醒" th:selected="${task.remind == '不提醒'}" >不提醒</option>
                       <option value="任务开始时提醒" th:selected="${task.remind == '任务开始时提醒'}">任务开始时提醒</option>
                       <option value="任务截止时提醒" th:selected="${task.remind == '任务截止时提醒'}" >任务截止时提醒</option>
                   </select>
               </div>
           </div>

           <div class="style-box clearfix">
               <div class="left-box">
                   <i class="layui-icon layui-icon-location" style="font-size: 15px; color: #a6a6a6;"></i>
                   <span>地点</span>
               </div>
               <div class="right-box">
                   <div class="wait-to">待添加</div>
                   <div class="add-something" style="display: none">
                       <input type="text" placeholder="待添加">
                       <div class="btn-box">
                           <div class="btn-ok-style">确定</div>
                           <div class="btn-no-style">取消</div>
                       </div>
                   </div>
               </div>
           </div>

           <div class="style-box clearfix">
               <div class="left-box">
                   <i class="layui-icon layui-icon-list" style="font-size: 15px; color: #a6a6a6;"></i>
                   <span>备注</span>
               </div>
               <div class="right-box">
                   <div class="wait-to">待添加</div>
                   <div class="add-something" style="display: none">
                       <input type="text" placeholder="待添加">
                       <div class="btn-box">
                           <div class="btn-ok-style">确定</div>
                           <div class="btn-no-style">取消</div>
                       </div>
                   </div>
               </div>
           </div>
           <!--标签-->
           <div class="add-tag clearfix ">
               <div class="left-box">
                   <i class="layui-icon layui-icon-note" style="font-size: 15px; color: #a6a6a6;"></i>
                   <span>标签</span>
               </div>
               <div class="no-tags-wrap">
                   <div class="tags">
                       <span class="no-tags">添加标签</span>
                   </div>
               </div>

               <!--新建  搜索标签框-->
               <!--<div class="tags-search-build" style="display: none">-->
                   <!--&lt;!&ndash;搜索标签&ndash;&gt;-->
                   <!--<div class="tag-search" >-->
                       <!--<div class="tag-search-title boxsizing">-->
                           <!--<input class="tag-search-input" type="text" placeholder="搜索标签">-->
                           <!--<img src="../static/image/adds.png" th:src="@{/image/adds.png}" />-->
                       <!--</div>-->
                       <!--<ul class="tags-ul boxsizing" id = "tags">-->
                           <!--&lt;!&ndash;这里是标签&ndash;&gt;-->
                           <!--<li class="tags-list">-->
                               <!--<span class="dot"></span>-->
                               <!--<span class="tag-font">aaa</span>-->
                           <!--</li>-->
                       <!--</ul>-->
                   <!--</div>-->
                   <!--&lt;!&ndash;新建标签&ndash;&gt;-->
                   <!--<div class="build-tags" style="display: none">-->
                       <!--<div class="build-tags-title boxsizing">-->
                           <!--<i class="layui-icon layui-icon-left go-return" style="font-size: 15px; color: #a6a6a6;"></i>-->
                           <!--新建标签-->
                           <!--<i class="layui-icon layui-icon-close close-tag" style="font-size: 15px; color: #a6a6a6;"></i>-->
                       <!--</div>-->
                       <!--<div class="build-tags-con boxsizing">-->
                           <!--<input class="tag-name boxsizing" type="text" placeholder="标签名称">-->
                           <!--<ul class="color-pick">-->
                               <!--<li>-->
                                   <!--<i class="layui-icon layui-icon-ok" style="font-size: 14px; color: #fff;display: block"></i>-->
                               <!--</li>-->
                               <!--<li>-->
                                   <!--<i class="layui-icon layui-icon-ok" style="font-size: 14px; color: #fff;"></i>-->
                               <!--</li>-->
                               <!--<li>-->
                                   <!--<i class="layui-icon layui-icon-ok" style="font-size: 14px; color: #fff;"></i>-->
                               <!--</li>-->
                               <!--<li>-->
                                   <!--<i class="layui-icon layui-icon-ok" style="font-size: 14px; color: #fff;"></i>-->
                               <!--</li>-->
                               <!--<li>-->
                                   <!--<i class="layui-icon layui-icon-ok" style="font-size: 14px; color: #fff;"></i>-->
                               <!--</li>-->
                               <!--<li>-->
                                   <!--<i class="layui-icon layui-icon-ok" style="font-size: 14px; color: #fff;"></i>-->
                               <!--</li>-->
                           <!--</ul>-->
                           <!--<button class="tag-ok" disabled>创建</button>-->
                       <!--</div>-->

                   <!--</div>-->
               <!--</div>-->


           </div>

           <div class="line"></div>

           <div class="guanlian combox">
               <img src="../static/image/guanlian.png" th:src="@{/image/guanlian.png}" />
               <span>关联内容</span>
           </div>
           <div class="add-guanlian combox">
               <img src="../static/image/adds.png" th:src="@{/image/adds.png}" />
               <span>添加关联</span>
           </div>
       </div>
        <div class="gray-box boxsizing">
            <p class="cyz">参与者</p>
            <div class="work-people boxsizing clearfix">
                <div class="one-work-people">
                    <img src="../static/image/add.png" th:src="@{/image/add.png}" />
                    <i class="layui-icon layui-icon-close-fill remove-work-people " style="font-size: 15px; color: #3da8f5;"></i>
                </div>
                <div class="add-work-people">
                    <img src="../static/image/adds.png" th:src="@{/image/adds.png}" />
                </div>
            </div>
            <div class="line"></div>
            <!--谁谁 干了 什么-->
            <div class="state">
                <ul id = "log">
                    <li class="combox" th:each="taskLog:${taskLog}">
                        <img src="../static/image/dongtai.png" th:src="@{/image/dongtai.png}" />
                        <span th:text="${taskLog.content}">aaa</span>
                        <div class="in-what-time" th:value = "${#dates.format(taskLog.createTime,'yyyy-MM-dd HH:mm')}">2018-10-1 12:00</div>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="publish boxsizing">
        <textarea name=""  placeholder="@快速提及他人，enter快速发布" class="layui-textarea publish-input" ></textarea>
        <div class="fenge-line"></div>
        <div class="publish-bottom">
            <i class="layui-icon layui-icon-file upload-fujian" style="font-size: 20px; color: #B5B5B5;"></i>
            <i class="layui-icon layui-icon-face-smile-fine" style="font-size: 20px; color: #B5B5B5;"></i>
            <div class="publish-btn ">发布</div>
        </div>
        <!--上传文件框-->
        <div class="fujian-box boxsizing" style="display: none">
            <div class="fujian-box-title boxsizing">
                添加附件
                <i class="layui-icon layui-icon-close close-fujian" style="font-size: 18px; color: #a6a6a6;"></i>
            </div>
            <div class="zj-up">
                <i class="layui-icon layui-icon-upload" style="font-size: 16px; color: #a6a6a6;"></i>
                <span>直接上传</span>
            </div>
            <div class="xian"></div>
            <div class="select-up">
                <i class="layui-icon layui-icon-file" style="font-size: 16px; color: #a6a6a6;"></i>
                <span>从文件库选择</span>
            </div>
            <div class="xian"></div>
            <div class="fujian-box-bottom boxsizing">
                <input type="text"  placeholder="粘贴下载链接..." class="layui-input lianjie">
                <div class="add-fujian">添加</div>
            </div>
        </div>

    </div>
</div>


</body>
<script th:src="@{/js/jquery-2.2.4.min.js}" src="../static/js/jquery-2.2.4.min.js"></script>
<script th:src="@{/layui/layui.js}" src="../static/layui/layui.js"></script>

<script>
    var project,groups,list;
    layui.use('form', function(){
        var form = layui.form;

        //监听提交
        form.on('submit(formDemo)', function(data){
            layer.msg(JSON.stringify(data.field));
            return false;
        });
        
        //重复 提醒 图标变蓝色
        form.on('select(repeat)', function(data){
           if (data.value=="不重复"){
               $(".repeat-img").attr("src","/static/image/norepeat.png")
           }else {
               $(".repeat-img").attr("src","/static/image/repeat-blue.png")
           }

        });
        form.on('select(remind)', function(data){
            if(data.value =="不提醒"){
                $(".remand-img").attr("src","/static/image/noremand.png")
            }else{
                $(".remand-img").attr("src","/static/image/tixing-blue.png")
            }

        });
    });
    layui.use('laydate', function(){
        var laydate = layui.laydate;

        //执行一个laydate实例
        laydate.render({
            elem: '#beginTimes', //指定元素
            type:'datetime',
            format:'M月d日 H点'
        });
        laydate.render({
            elem: '#overTimes', //指定元素
            type:'datetime',
            format:'M月d日 H点'
        });
    });
    $(function () {
        // 点击添加 出现 添加内容 区域
        $(".wait-to").click(function () {
            $(this).siblings(".add-something").show();
            $(this).siblings(".add-something").find("input").val($(this).text());
            $(this).hide();
        });
        $(".btn-no-style").click(function () {
            $(this).parents(".add-something").siblings(".wait-to").show();
            $(this).parents(".add-something").hide()
        });
        //点击添加区域的确定按钮
        $(".btn-ok-style").click(function () {
            $(this).parents(".add-something").siblings(".wait-to").show();
            var value=$(this).parents(".add-something").find("input").val();
            $(this).parents(".add-something").siblings(".wait-to").text(value);
            $(this).parents(".add-something").hide()
        });

        //点击 添加附件 图标
        $(".upload-fujian").click(function () {
            $(".fujian-box").slideToggle();
        });
        $(".close-fujian").click(function () {
            $(".fujian-box").slideUp();
        });

        //点击日程菜单 按钮
        $(".assignment-menu-show").click(function () {
            var top=$(this).offset().top+50;
            var left=$(this).offset().left-170;
            richengMenu(top,left)

        });

        //点击 标签
        $(".tags").click(function (e) {
            $(".tags-search-build").show();
            e.stopPropagation()
        });
        $(".tag-search-title img").click(function () {
            $(".build-tags").show();
            $(".tag-search").hide()
        });
        $(".go-return").click(function () {
            $(".build-tags").hide();
            $(".tag-search").show()
        });
        $(".close-tag").click(function () {
            $(".tags-search-build").hide()
        });
        
        //点击 标签 ，添加一个标签
        // $(".tags-list").click(function () {
        //     $(".no-tags").hide();
        //     $(".tags").append('<div class="one-tag" >\n' +
        //         '                           <span style="background-color: \'+$(this).find(".dot").css("background-color")+\'">'+ $(this).find(".tag-font").text()+'</span>\n' +
        //         '                           <i class="layui-icon layui-icon-close-fill remove-tag" style="font-size: 15px; color: #2a75ab;"></i>\n' +
        //         '                       </div>')
        // });
        //点击 x 移出标签
        $(".tags").on("click",".remove-tag",function (e) {
           $(this).parent().remove();
           if ($(".tags").find(".one-tag").length==0){
               $(".no-tags").show()
           }
           e.stopPropagation()
        });
        //点击空白区域 选择标签 框 消失
        // $(document).click(function(event){
        //     var _con = $('.tags-search-build');  // 设置目标区域
        //     if(!_con.is(event.target) && _con.has(event.target).length === 0){ // Mark 1
        //         $('.tags-search-build').hide(100);     //淡出消失
        //     }
        // });

        //点击 选择  颜色
        // $("html").on("click",".color-pick li",function () {
        //     $(".color-pick li i").hide();
        //     $(this).find("i").show()
        // });




        //点击 关闭按钮  关闭弹出层
        $(".close-revise-task").click(function () {
            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
            parent.layer.close(index); //再执行关闭
        });



        //点击添加人员 出现 弹框
        $(".add-work-people img").click(function () {
            addpeople()
        })


    });
//添加人员 弹框
    function addpeople() {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 2,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false, //标题
                offset:['0px','0px'],
                area:['252px','360px'],
                fixed: true,
                shadeClose: true,
                closeBtn: 0,
                shade: [0.1, '#fff'],
                anim: 1,  //动画 0-6
                content: "tk-search-people.html",
                zIndex: layer.zIndex, //重点1
                success: function(layero){
                    layer.setTop(layero); //重点2
                }
            });
        });
    }

    //日程菜单 弹框
    function richengMenu(top,left) {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 2,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false,
                offset:[top,left],
                area:['220px','470px'],
                fixed: true,
                shadeClose: true,
                closeBtn: 0,
                shade: [0.1, '#fff'],
                anim: 1,  //动画 0-6
                content: "tk-richengcaidan.html",
                zIndex: layer.zIndex, //重点1
                success: function(layero){
                    layer.setTop(layero); //重点2
                }
            });
        });
    }

    //添加标签 弹框
    $(".tags").click(function () {
        var top= $(this).offset().top+40;
        var left=$(this).offset().left;
        addtag(top,left)
    });
    function addtag(top,left) {
        layui.use('layer', function(){
            var layer = layui.layer;
            layer.open({
                type: 2,  //0（信息框，默认）1（页面层）2（iframe层）3（加载层）4（tips层）
                title: false, //标题
                offset:[top,left],
                area:['250px','250px'],
                fixed: true,
                shadeClose: true,
                closeBtn: 0,
                shade: [0.1, '#fff'],
                anim: 1,  //动画 0-6
                content: "tk-add-tag.html"
            });
        });
    }


</script>
</html>